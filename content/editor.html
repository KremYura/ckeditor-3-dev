<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>mozeditor - Editing content</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link href="editor.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="./ckeditor/ckeditor_source.js"></script>
</head>
<body>

	<form action="#">
		<textarea id="contents"></textarea>
		<script type="text/javascript">
<!--

var config = {};
config.height = '100%'; // this doesnt' work properly in CKEditor
config.customConfig = '../plugins/config.js';

var args, data = '';
if (document.location.protocol === 'chrome:')
{
	if (window.arguments)
		args = window.arguments[0];
	else
		args = parent.parent.mozeditor.editorInfo;

	data = args.data ;
	config.baseHref = args.baseHref ;
//	oFCKeditor.Config['EditorAreaStyles'] = '';
	if (args.styleSheets)
	{
		config.contentsCss = args.styleSheets;
//		oFCKeditor.Config['EditorAreaStyles'] = args.styles  ;
	}
	if (args.bodyId)
		config.bodyId = args.bodyId ;
	if (args.bodyClass)
		config.bodyClass = args.bodyClass ;
//	if (args.bodyStyle)
//		oFCKeditor.Config['EditorAreaStyles'] = oFCKeditor.Config['EditorAreaStyles'] + ';\r\nbody {' + args.bodyStyle + '}' ;
}

var contents = document.getElementById("contents");
contents.value = data;
var editor = CKEDITOR.replace(contents, config);
editor.on( 'afterCommandExec', function( event )
{
	if ( event.data.name == 'save' )
		UpdateContent();
});

function UpdateContent()
{
	// get access to the window with all the code:
//	var mainWindow = document.getElementById('FCKeditor1___Frame').contentWindow ;
//	mainWindow.ChromePreferences.SavePreferences() ;
	var value = editor.getData() ;
	//Destroy
	args.closeFunction( value ) ;
	return false ;
}
//-->
		</script>
	</form>
</body>
</html>
